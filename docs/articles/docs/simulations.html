<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Network Simulation • shine</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../../bootstrap-toc.css">
<script src="../../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../../pkgdown.css" rel="stylesheet">
<script src="../../pkgdown.js"></script><meta property="og:title" content="Network Simulation">
<meta property="og:description" content="shine">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../../index.html">shine</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../../index.html">Home</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Examples
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../../articles/docs/simulations.html">Simulating Graphs</a>
    </li>
    <li>
      <a href="../../articles/docs/filtering.html">Filtering Methods</a>
    </li>
    <li>
      <a href="../../articles/docs/constraints.html">Structure Constraints</a>
    </li>
    <li>
      <a href="../../articles/docs/learning.html">Network Learning</a>
    </li>
  </ul>
</li>
<li>
  <a href="../../reference/index.html">Functionality</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/montilab/shine">
    <span class="fas fa-github"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="simulations_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Network Simulation</h1>
            
      
      
      <div class="hidden name"><code>simulations.Rmd</code></div>

    </div>

    
    
<div id="a-single-network" class="section level1">
<h1 class="hasAnchor">
<a href="#a-single-network" class="anchor"></a>A Single Network</h1>
<p>When learning networks, it may be useful to test different methods on simulated data. To help with this, we provide some useful functions for simulating undirected networks through different modeling approaches relevant to biological networks.</p>
<div id="flat-structures" class="section level2">
<h2 class="hasAnchor">
<a href="#flat-structures" class="anchor"></a>Flat Structures</h2>
<div id="scale-free-model" class="section level3">
<h3 class="hasAnchor">
<a href="#scale-free-model" class="anchor"></a>Scale-free Model</h3>
<p>A relevant model for biological networks utilizes the <a href="https://en.wikipedia.org/wiki/Barab%C3%A1si%E2%80%93Albert_model">Barabási–Albert model</a> for generating random scale-free networks using a preferential attachment mechanism. It incorporates two important general concepts: growth and preferential attachment. Both growth and preferential attachment exist widely in real networks.</p>
<ul>
<li>Growth means that the number of nodes in the network increases over time.<br>
</li>
<li>Preferential attachment means that the more connected a node is, the more likely it is to receive new links.</li>
</ul>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">shine</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">g</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/model.pa.html">model.pa</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span>
<span class="fu"><a href="../../reference/model.plot.html">model.plot</a></span><span class="op">(</span><span class="va">g</span><span class="op">)</span></code></pre></div>
<p><img src="simulations_files/figure-html/unnamed-chunk-3-1.png" width="700" style="display: block; margin: auto;"></p>
<p>Graphs are initalized with a single node and extended iteratively as new nodes are added to the graph with an edge to an existing node with some probability. This probability is determined partially by the power argument, which gives more or less preference to high-degree nodes. This leads to scale-free structures where a few nodes are hubs in the graph.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">g1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/model.pa.html">model.pa</a></span><span class="op">(</span><span class="fl">100</span>, power<span class="op">=</span><span class="fl">1</span><span class="op">)</span>
<span class="va">g2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/model.pa.html">model.pa</a></span><span class="op">(</span><span class="fl">100</span>, power<span class="op">=</span><span class="fl">1.3</span><span class="op">)</span>
<span class="va">g3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/model.pa.html">model.pa</a></span><span class="op">(</span><span class="fl">100</span>, power<span class="op">=</span><span class="fl">1.5</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="../../reference/model.plot.html">model.plot</a></span><span class="op">(</span><span class="va">g1</span><span class="op">)</span>
<span class="fu"><a href="../../reference/model.plot.html">model.plot</a></span><span class="op">(</span><span class="va">g2</span><span class="op">)</span>
<span class="fu"><a href="../../reference/model.plot.html">model.plot</a></span><span class="op">(</span><span class="va">g3</span><span class="op">)</span></code></pre></div>
<p><img src="simulations_files/figure-html/unnamed-chunk-4-1.png" width="1152" style="display: block; margin: auto;"></p>
</div>
<div id="small-world-model" class="section level3">
<h3 class="hasAnchor">
<a href="#small-world-model" class="anchor"></a>Small World Model</h3>
<p>Another relevant model for biological networks utilizes the <a href="https://en.wikipedia.org/wiki/Watts%E2%80%93Strogatz_model">Watts–Strogatz model</a> for generating random graphs with the small world properties, including short average path lengths and high clustering.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">g</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/model.sw.html">model.sw</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span>
<span class="fu"><a href="../../reference/model.plot.html">model.plot</a></span><span class="op">(</span><span class="va">g</span><span class="op">)</span></code></pre></div>
<p><img src="simulations_files/figure-html/unnamed-chunk-5-1.png" width="700" style="display: block; margin: auto;"></p>
</div>
<div id="random-model" class="section level3">
<h3 class="hasAnchor">
<a href="#random-model" class="anchor"></a>Random Model</h3>
<p>Perhaps the simplest model is the <a href="https://en.wikipedia.org/wiki/Erd%C5%91s%E2%80%93R%C3%A9nyi_model">Erdős–Rényi model</a> for generating random graphs. Through this algorithm, nodes are initalized and edges are drawn arbitrarily at a given probability.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">g</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/model.er.html">model.er</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">0.05</span><span class="op">)</span>
<span class="fu"><a href="../../reference/model.plot.html">model.plot</a></span><span class="op">(</span><span class="va">g</span><span class="op">)</span></code></pre></div>
<p><img src="simulations_files/figure-html/unnamed-chunk-6-1.png" width="700" style="display: block; margin: auto;"></p>
</div>
</div>
<div id="modular-structures" class="section level2">
<h2 class="hasAnchor">
<a href="#modular-structures" class="anchor"></a>Modular Structures</h2>
<div id="modular-preferential-attachment" class="section level3">
<h3 class="hasAnchor">
<a href="#modular-preferential-attachment" class="anchor"></a>Modular Preferential Attachment</h3>
<p>Here is an extension of the preferential attachment algorithm where multiple scale-free models are randomly connected to simulate networks that have both modular and scale-free properties which are recognized in biological networks.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">g</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/model.mpa.html">model.mpa</a></span><span class="op">(</span><span class="fl">200</span><span class="op">)</span>
<span class="fu"><a href="../../reference/model.plot.html">model.plot</a></span><span class="op">(</span><span class="va">g</span><span class="op">)</span></code></pre></div>
<p><img src="simulations_files/figure-html/unnamed-chunk-7-1.png" width="700" style="display: block; margin: auto;"></p>
</div>
<div id="lancichinettifortunatoradicchi-benchmark" class="section level3">
<h3 class="hasAnchor">
<a href="#lancichinettifortunatoradicchi-benchmark" class="anchor"></a>Lancichinetti–Fortunato–Radicchi Benchmark</h3>
<p>For a more robust approach to generating modular scale-free networks, we use the <a href="https://networkx.org/documentation/stable/reference/generated/networkx.generators.community.LFR_benchmark_graph.html#networkx.generators.community.LFR_benchmark_graph">LFR model</a> to generate scale-free networks (degree distribution follows a power law) and also contain a modularity component (high clustering coefficient). These are two important structural properties observed in real biological networks. The most robust implementation of LFR is written in python via the <code>networkx</code> package.</p>
<p>This can be installed and used as follows..</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb7-1"><a href="#cb7-1"></a><span class="ex">pip</span> install networkx</span>
<span id="cb7-2"><a href="#cb7-2"></a><span class="ex">pip</span> install numpy</span>
<span id="cb7-3"><a href="#cb7-3"></a><span class="ex">pip</span> install scipy</span></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1"></a><span class="im">import</span> networkx <span class="im">as</span> nx</span>
<span id="cb8-2"><a href="#cb8-2"></a><span class="im">from</span> networkx.generators.community <span class="im">import</span> LFR_benchmark_graph</span>
<span id="cb8-3"><a href="#cb8-3"></a></span>
<span id="cb8-4"><a href="#cb8-4"></a>G <span class="op">=</span> LFR_benchmark_graph(n<span class="op">=</span><span class="dv">500</span>,</span>
<span id="cb8-5"><a href="#cb8-5"></a>                        tau1<span class="op">=</span><span class="fl">2.7</span>,</span>
<span id="cb8-6"><a href="#cb8-6"></a>                        tau2<span class="op">=</span><span class="dv">2</span>,</span>
<span id="cb8-7"><a href="#cb8-7"></a>                        mu<span class="op">=</span><span class="fl">0.09</span>,</span>
<span id="cb8-8"><a href="#cb8-8"></a>                        max_iters<span class="op">=</span><span class="dv">250</span>,</span>
<span id="cb8-9"><a href="#cb8-9"></a>                        average_degree<span class="op">=</span><span class="dv">5</span>,</span>
<span id="cb8-10"><a href="#cb8-10"></a>                        min_community<span class="op">=</span><span class="dv">10</span>,</span>
<span id="cb8-11"><a href="#cb8-11"></a>                        max_community<span class="op">=</span><span class="dv">50</span>,</span>
<span id="cb8-12"><a href="#cb8-12"></a>                        seed<span class="op">=</span><span class="dv">1</span>,</span>
<span id="cb8-13"><a href="#cb8-13"></a>                        <span class="op">**</span>kwargs)</span></code></pre></div>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">g</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, package<span class="op">=</span><span class="st">"shine"</span><span class="op">)</span>, <span class="st">"models.rds"</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="../../reference/model.plot.html">model.plot</a></span><span class="op">(</span><span class="va">g</span><span class="op">)</span></code></pre></div>
<p><img src="simulations_files/figure-html/unnamed-chunk-8-1.png" width="700" style="display: block; margin: auto;"></p>
</div>
</div>
</div>
<div id="multiple-networks" class="section level1">
<h1 class="hasAnchor">
<a href="#multiple-networks" class="anchor"></a>Multiple Networks</h1>
<p>When estimating multiple networks underlying similar biological phenotypes, one may assume networks share some structural features. To generate multiple scale-free networks that share features with a known similarity, we can modify the Barabási–Albert algorithm with the following steps:</p>
<ul>
<li>Seed the algorithm with a relatively small graph<br>
</li>
<li>For multiple networks, run the algorithm independently multiple times, each diverging from the seed. Due to the preferential attachment mechanism, hub nodes in one network will remain hubs in another, potentially with different targets.<br>
</li>
<li>Calculate the mean pairwise overlap similarity of edges between networks.</li>
</ul>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">g</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/model.pa.html">model.pa</a></span><span class="op">(</span><span class="fl">100</span>, power<span class="op">=</span><span class="fl">1.3</span><span class="op">)</span>
<span class="fu"><a href="../../reference/model.plot.html">model.plot</a></span><span class="op">(</span><span class="va">g</span><span class="op">)</span></code></pre></div>
<p><img src="simulations_files/figure-html/unnamed-chunk-9-1.png" width="700" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">graphs</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/model.hpa.html">model.hpa</a></span><span class="op">(</span><span class="fl">3</span>, p<span class="op">=</span><span class="fl">120</span>, seed<span class="op">=</span><span class="va">g</span>, power<span class="op">=</span><span class="fl">1.3</span><span class="op">)</span>
<span class="fu"><a href="../../reference/models.plot.html">models.plot</a></span><span class="op">(</span><span class="va">graphs</span><span class="op">)</span></code></pre></div>
<p><img src="simulations_files/figure-html/unnamed-chunk-10-1.png" width="1152" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">percent</span><span class="op">(</span><span class="fu"><a href="../../reference/models.similarity.html">models.similarity</a></span><span class="op">(</span><span class="va">graphs</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>[1] "84%"</code></pre>
</div>
<div id="generating-data" class="section level1">
<h1 class="hasAnchor">
<a href="#generating-data" class="anchor"></a>Generating Data</h1>
<p>We can use any of the models to simulate expression data that follows a multivariate Gaussian distribution, which is formatted as an Expression Set object, which is the primary input to downstream functions.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">g</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/model.pa.html">model.pa</a></span><span class="op">(</span><span class="fl">100</span>, power<span class="op">=</span><span class="fl">1.3</span><span class="op">)</span>
<span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/model.sim.html">model.sim</a></span><span class="op">(</span><span class="fl">50</span>, <span class="va">g</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">eset</span><span class="op">)</span></code></pre></div>
<pre><code>Features  Samples 
     100       50 </code></pre>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by <a href="https://github.com/anfederico">Anthony Federico</a>, <a href="https://github.com/tetomonti">Stefano Monti</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
