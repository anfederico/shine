<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Hierarchical Networks • shine</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../../pkgdown.css" rel="stylesheet">
<script src="../../pkgdown.js"></script><meta property="og:title" content="Hierarchical Networks">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../../index.html">shine</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../../index.html">Home</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Examples
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../../articles/docs/simulations.html">Simulating Graphs</a>
    </li>
    <li>
      <a href="../../articles/docs/filtering.html">Filtering Methods</a>
    </li>
    <li>
      <a href="../../articles/docs/constraints.html">Structure Learning Constraints</a>
    </li>
    <li>
      <a href="../../articles/docs/hierarchy.html">Hierarchical Networks</a>
    </li>
    <li>
      <a href="../../articles/docs/netviz.html">Network Visualization</a>
    </li>
  </ul>
</li>
<li>
  <a href="../../reference/index.html">Functionality</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/montilab/shine">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="hierarchy_files/htmlwidgets-1.5.1/htmlwidgets.js"></script><script src="hierarchy_files/viz-0.3/viz.js"></script><link href="hierarchy_files/DiagrammeR-styles-0.2/styles.css" rel="stylesheet">
<script src="hierarchy_files/grViz-binding-1.0.1/grViz.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Hierarchical Networks</h1>
            
      
      
      <div class="hidden name"><code>hierarchy.Rmd</code></div>

    </div>

    
    
<p>Due to the heavy computational requirements for high-dimensional graphical modeling, we learn network hierarchies in paralell on high performance computing platforms. Because some networks are dependent on others (e.g. A network is used as a prior in learning another) we need a reactive workflow to handle all of the processes.</p>
<p>We provide a function for generating <a href="https://www.nextflow.io/">Nextflow</a> workflows based on your hierarchy. Using Nextflow in this way enables the deployment of flexible and reactive workflows on various high performance computing platforms. This not only simplifies the process of estimating network hierarchies on different cloud/cluster architectures, but it also makes your results reproducible.</p>
<p>This is the last step in learning networks. At this point, you should have identified a network hierarchy, employed a gene selection method, and optionally learned structural constraints for your networks.</p>
<div id="requirements-for-nextflow" class="section level1">
<h1 class="hasAnchor">
<a href="#requirements-for-nextflow" class="anchor"></a>Requirements for Nextflow</h1>
<p>Make sure your Java installation is version 8 or higher…</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1"></a><span class="ex">java</span> -version</span></code></pre></div>
<p>Create a new directory and install/test Nextflow…</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1"></a><span class="fu">mkdir</span> nf-test</span>
<span id="cb2-2"><a href="#cb2-2"></a><span class="bu">cd</span> nf-test</span>
<span id="cb2-3"><a href="#cb2-3"></a><span class="ex">curl</span> -s https://get.nextflow.io <span class="kw"><a href="https://rdrr.io/r/base/Logic.html">|</a></span> <span class="fu">bash</span></span>
<span id="cb2-4"><a href="#cb2-4"></a><span class="ex">./nextflow</span> run hello</span></code></pre></div>
<p>Alternatively, you can install <a href="https://docs.docker.com/install/">Docker</a> and pull our <a href="https://github.com/montilab/shine/packages">Dockerfile</a>…</p>
<pre><code>docker run hello-world
docker pull docker.pkg.github.com/montilab/shine/workflow:latest</code></pre>
</div>
<div id="terminology" class="section level1">
<h1 class="hasAnchor">
<a href="#terminology" class="anchor"></a>Terminology</h1>
<p><code>hierarchy</code> - A string describing the hierarchy in dot language notation<br><code>condition</code> - A column in the expression set phenotype data used to assign samples to different networks<br><code>eset</code> - An expression set object containing all samples across multiple networks<br><code>blanket</code> - A gene x gene matrix of structural constraints for network learning<br><code>outdir</code> - A directory where workflow will be created<br><code>iter</code> - The number of iterations for the sampling algorithm<br><code>cores</code> - The number of cores for each network to use for parallel execution</p>
</div>
<div id="example-data" class="section level1">
<h1 class="hasAnchor">
<a href="#example-data" class="anchor"></a>Example Data</h1>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(shine)</span></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a><span class="kw"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(toy)</span></code></pre></div>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a><span class="kw"><a href="https://rdrr.io/r/base/dim.html">dim</a></span>(toy)</span></code></pre></div>
<pre><code>Features  Samples 
     150       30 </code></pre>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a><span class="kw"><a href="https://rdrr.io/r/base/table.html">table</a></span>(toy<span class="op">$</span>subtype)</span></code></pre></div>
<pre><code>
 A  B  C 
10 10 10 </code></pre>
</div>
<div id="describing-hierarchies" class="section level1">
<h1 class="hasAnchor">
<a href="#describing-hierarchies" class="anchor"></a>Describing Hierarchies</h1>
<p>Hierarchies are described using notation for directed graphs described with the <a href="https://www.graphviz.org/doc/info/lang.html">DOT</a> language. This format is used to describe which parent networks are used as priors for learning child networks.</p>
<p><em>Notes</em><br>
- Groups must be separated by <code>_</code> only<br>
- Group labels cannot contain spaces<br>
- Only directed notation <code>-&gt;</code> can be used</p>
<p>This most simple workflow includes building networks for groups A, B, and C without any prior information.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a>condition &lt;-<span class="st"> "subtype"</span></span>
<span id="cb10-2"><a href="#cb10-2"></a>hierarchy &lt;-<span class="st"> "</span></span>
<span id="cb10-3"><a href="#cb10-3"></a><span class="st">A</span></span>
<span id="cb10-4"><a href="#cb10-4"></a><span class="st">B</span></span>
<span id="cb10-5"><a href="#cb10-5"></a><span class="st">C</span></span>
<span id="cb10-6"><a href="#cb10-6"></a><span class="st">"</span></span>
<span id="cb10-7"><a href="#cb10-7"></a></span>
<span id="cb10-8"><a href="#cb10-8"></a><span class="kw"><a href="../../reference/plt.hierarchy.html">plt.hierarchy</a></span>(hierarchy)</span></code></pre></div>
<div id="htmlwidget-5aae0551ee46816c39e8" style="width:288px;height:96px;" class="grViz html-widget"></div>
<script type="application/json" data-for="htmlwidget-5aae0551ee46816c39e8">{"x":{"diagram":"digraph dot {\n     graph [layout = dot]\n     node [shape = circle,\n           style = filled,\n           color = black,\n           style = filled,\n           fillcolor = AliceBlue,\n           fontname = Futura]\n     edge [color = black]\n     \nA\nB\nC\n\n    }","config":{"engine":"dot","options":null}},"evals":[],"jsHooks":[]}</script><p>Here we first learn the root network - combining samples from groups A, B, and C - and then use this network as a prior for learning each group individually.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a>condition &lt;-<span class="st"> "subtype"</span></span>
<span id="cb11-2"><a href="#cb11-2"></a>hierarchy &lt;-<span class="st"> "</span></span>
<span id="cb11-3"><a href="#cb11-3"></a><span class="st">A_B_C -&gt; A</span></span>
<span id="cb11-4"><a href="#cb11-4"></a><span class="st">A_B_C -&gt; B</span></span>
<span id="cb11-5"><a href="#cb11-5"></a><span class="st">A_B_C -&gt; C</span></span>
<span id="cb11-6"><a href="#cb11-6"></a><span class="st">"</span></span>
<span id="cb11-7"><a href="#cb11-7"></a></span>
<span id="cb11-8"><a href="#cb11-8"></a><span class="kw"><a href="../../reference/plt.hierarchy.html">plt.hierarchy</a></span>(hierarchy)</span></code></pre></div>
<div id="htmlwidget-0142c3221fbe24156fa4" style="width:288px;height:192px;" class="grViz html-widget"></div>
<script type="application/json" data-for="htmlwidget-0142c3221fbe24156fa4">{"x":{"diagram":"digraph dot {\n     graph [layout = dot]\n     node [shape = circle,\n           style = filled,\n           color = black,\n           style = filled,\n           fillcolor = AliceBlue,\n           fontname = Futura]\n     edge [color = black]\n     \nA_B_C -> A\nA_B_C -> B\nA_B_C -> C\n\n    }","config":{"engine":"dot","options":null}},"evals":[],"jsHooks":[]}</script><p>Here is the same as previously, except there are internal nodes which are learned before dependent leaf nodes.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a>condition &lt;-<span class="st"> "subtype"</span></span>
<span id="cb12-2"><a href="#cb12-2"></a>hierarchy &lt;-<span class="st"> "</span></span>
<span id="cb12-3"><a href="#cb12-3"></a><span class="st">A_B_C -&gt; A_B</span></span>
<span id="cb12-4"><a href="#cb12-4"></a><span class="st">A_B_C -&gt; C</span></span>
<span id="cb12-5"><a href="#cb12-5"></a><span class="st">A_B -&gt; A</span></span>
<span id="cb12-6"><a href="#cb12-6"></a><span class="st">A_B -&gt; B</span></span>
<span id="cb12-7"><a href="#cb12-7"></a><span class="st">"</span></span>
<span id="cb12-8"><a href="#cb12-8"></a></span>
<span id="cb12-9"><a href="#cb12-9"></a><span class="kw"><a href="../../reference/plt.hierarchy.html">plt.hierarchy</a></span>(hierarchy)</span></code></pre></div>
<div id="htmlwidget-1d872c41eb1c1ef85343" style="width:288px;height:288px;" class="grViz html-widget"></div>
<script type="application/json" data-for="htmlwidget-1d872c41eb1c1ef85343">{"x":{"diagram":"digraph dot {\n     graph [layout = dot]\n     node [shape = circle,\n           style = filled,\n           color = black,\n           style = filled,\n           fillcolor = AliceBlue,\n           fontname = Futura]\n     edge [color = black]\n     \nA_B_C -> A_B\nA_B_C -> C\nA_B -> A\nA_B -> B\n\n    }","config":{"engine":"dot","options":null}},"evals":[],"jsHooks":[]}</script>
</div>
<div id="filtering-and-constraints" class="section level1">
<h1 class="hasAnchor">
<a href="#filtering-and-constraints" class="anchor"></a>Filtering and Constraints</h1>
<p>He we repeat methods detailed in previous sections for variable selection and complexity reduction.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a><span class="co"># Filter out non-varying genes</span></span>
<span id="cb13-2"><a href="#cb13-2"></a>genes.filtered &lt;-<span class="st"> </span><span class="kw"><a href="../../reference/filter.var.html">filter.var</a></span>(toy, <span class="dt">column=</span><span class="st">"subtype"</span>, <span class="dt">subtypes=</span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span>))</span>
<span id="cb13-3"><a href="#cb13-3"></a></span>
<span id="cb13-4"><a href="#cb13-4"></a><span class="co"># Select top genes by median absolute deviation</span></span>
<span id="cb13-5"><a href="#cb13-5"></a>genes.selected &lt;-<span class="st"> </span><span class="kw"><a href="../../reference/select.var.html">select.var</a></span>(toy, <span class="dt">column=</span><span class="st">"subtype"</span>, <span class="dt">subtypes=</span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span>), <span class="dt">genes=</span>genes.filtered, <span class="dt">limit=</span><span class="dv">150</span>)</span>
<span id="cb13-6"><a href="#cb13-6"></a></span>
<span id="cb13-7"><a href="#cb13-7"></a><span class="co"># Subset toy dataset</span></span>
<span id="cb13-8"><a href="#cb13-8"></a>eset &lt;-<span class="st"> </span>toy[genes.selected,]</span>
<span id="cb13-9"><a href="#cb13-9"></a></span>
<span id="cb13-10"><a href="#cb13-10"></a><span class="co"># Find constraints for structure with zero-order correlations</span></span>
<span id="cb13-11"><a href="#cb13-11"></a>wgcna &lt;-<span class="st"> </span><span class="kw"><a href="../../reference/mods.detect.html">mods.detect</a></span>(eset, <span class="dt">min.size=</span><span class="dv">5</span>, <span class="dt">cores=</span><span class="dv">3</span>, <span class="dt">do.plot=</span><span class="ot">FALSE</span>)</span>
<span id="cb13-12"><a href="#cb13-12"></a>metanet &lt;-<span class="st"> </span><span class="kw"><a href="../../reference/bdg.metanet.html">bdg.metanet</a></span>(wgcna<span class="op">$</span>eigengenes, <span class="dt">cut=</span><span class="fl">0.5</span>, <span class="dt">mpl=</span><span class="ot">TRUE</span>, <span class="dt">iter=</span><span class="dv">20000</span>, <span class="dt">cores=</span><span class="dv">3</span>)</span>
<span id="cb13-13"><a href="#cb13-13"></a></span>
<span id="cb13-14"><a href="#cb13-14"></a><span class="co"># Set constraints</span></span>
<span id="cb13-15"><a href="#cb13-15"></a>blanket &lt;-<span class="st"> </span><span class="kw"><a href="../../reference/blanket.new.html">blanket.new</a></span>(wgcna<span class="op">$</span>genes)</span>
<span id="cb13-16"><a href="#cb13-16"></a>blanket &lt;-<span class="st"> </span><span class="kw"><a href="../../reference/blanket.lift.html">blanket.lift</a></span>(blanket, wgcna<span class="op">$</span>mods, metanet<span class="op">$</span>edges)</span></code></pre></div>
</div>
<div id="generative-workflows" class="section level1">
<h1 class="hasAnchor">
<a href="#generative-workflows" class="anchor"></a>Generative Workflows</h1>
<p>In summary, a hierarchy of networks must be defined using sample names of a particular condition in the expression set object. If variable selection is required, the expression set should be subset on these variables beforehand. And if structural constraints are used, the rownames and colnames of the blanket matrix should match the selected variables. Once setup, use the following function to generate a reactive workflow based on the hierarchy.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a><span class="kw"><a href="../../reference/build.workflow.html">build.workflow</a></span>(hierarchy,</span>
<span id="cb14-2"><a href="#cb14-2"></a>               condition,</span>
<span id="cb14-3"><a href="#cb14-3"></a>               eset,</span>
<span id="cb14-4"><a href="#cb14-4"></a>               blanket,</span>
<span id="cb14-5"><a href="#cb14-5"></a>               <span class="dt">iter=</span><span class="dv">10000</span>,</span>
<span id="cb14-6"><a href="#cb14-6"></a>               <span class="dt">cores=</span><span class="dv">3</span>)</span></code></pre></div>
<p>Building the workflow results in the creation of a directory with the following contents.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode md"><code class="sourceCode markdown"><span id="cb15-1"><a href="#cb15-1"></a>/workflow</span>
<span id="cb15-2"><a href="#cb15-2"></a> ├── /configs</span>
<span id="cb15-3"><a href="#cb15-3"></a> ├── /scripts</span>
<span id="cb15-4"><a href="#cb15-4"></a> ├── /templates</span>
<span id="cb15-5"><a href="#cb15-5"></a> ├── workflow.config</span>
<span id="cb15-6"><a href="#cb15-6"></a> ├── workflow.nf</span>
<span id="cb15-7"><a href="#cb15-7"></a> └── nextflow</span></code></pre></div>
<p><code>/configs</code> - A directory of inheritable configurations [*]<br><code>/scripts</code> - Scripts used by the workflow<br><code>/templates</code> - Templates used by the workflow<br><code>workflow.config</code> - Workflow configuration file [*]<br><code>workflow.nf</code> - Dynamically generated workflow<br><code>nextflow</code> - Nextflow executable</p>
<p>Most files should not be modified, except the configuration files…</p>
<div id="workflow-configuration" class="section level3">
<h3 class="hasAnchor">
<a href="#workflow-configuration" class="anchor"></a>Workflow Configuration</h3>
<p>The configuration is quite simple. One option you might want to change is the output of the workflow. This is where the result networks and logs will be saved. If you want an update when the workflow completes, put in your email! You’ll likely need to edit the profile configurations, particularly if you are running on a cluster. The local profile will work out of the box, but docker, aws, and sge are popular examples.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode md"><code class="sourceCode markdown"><span id="cb16-1"><a href="#cb16-1"></a>profiles {</span>
<span id="cb16-2"><a href="#cb16-2"></a>  local {includeConfig "configs/local.config"}</span>
<span id="cb16-3"><a href="#cb16-3"></a>  docker {includeConfig "configs/docker.config"}</span>
<span id="cb16-4"><a href="#cb16-4"></a>  sge {includeConfig "configs/sge.config"}</span>
<span id="cb16-5"><a href="#cb16-5"></a>  aws {includeConfig "configs/aws.config"}</span>
<span id="cb16-6"><a href="#cb16-6"></a>}</span>
<span id="cb16-7"><a href="#cb16-7"></a></span>
<span id="cb16-8"><a href="#cb16-8"></a>params {</span>
<span id="cb16-9"><a href="#cb16-9"></a>  data = "$baseDir/data/data.rds"</span>
<span id="cb16-10"><a href="#cb16-10"></a>  output = "$baseDir"</span>
<span id="cb16-11"><a href="#cb16-11"></a>  email = ""</span>
<span id="cb16-12"><a href="#cb16-12"></a>}</span></code></pre></div>
</div>
<div id="workflow-design" class="section level3">
<h3 class="hasAnchor">
<a href="#workflow-design" class="anchor"></a>Workflow Design</h3>
<p>This configuration file parameterizes a workflow that looks something like the following example. The learning of each network is described as a process, where some are dependent on others. In this case, processes A, B, and C are dependent on process A_B_C <code>input: file prior from A_B_C_rds</code>. Therefore, these processes will not start until A_B_C is finished.</p>
<p>If something goes wrong with process A_B_C, the workflow will only finish other non-dependent processes. Once the user fixes the error, the workflow can be resumed without any loss of progress.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode md"><code class="sourceCode markdown"><span id="cb17-1"><a href="#cb17-1"></a>process A_B_C {</span>
<span id="cb17-2"><a href="#cb17-2"></a><span class="bn">    input:</span></span>
<span id="cb17-3"><a href="#cb17-3"></a><span class="bn">    val include from "A B C"</span></span>
<span id="cb17-4"><a href="#cb17-4"></a></span>
<span id="cb17-5"><a href="#cb17-5"></a><span class="bn">    output:</span></span>
<span id="cb17-6"><a href="#cb17-6"></a><span class="bn">    file '*.rds' into A_B_C_rds</span></span>
<span id="cb17-7"><a href="#cb17-7"></a>}</span>
<span id="cb17-8"><a href="#cb17-8"></a></span>
<span id="cb17-9"><a href="#cb17-9"></a>process A {</span>
<span id="cb17-10"><a href="#cb17-10"></a><span class="bn">    input:</span></span>
<span id="cb17-11"><a href="#cb17-11"></a><span class="bn">    val include from "A"</span></span>
<span id="cb17-12"><a href="#cb17-12"></a><span class="bn">    file prior from A_B_C_rds</span></span>
<span id="cb17-13"><a href="#cb17-13"></a></span>
<span id="cb17-14"><a href="#cb17-14"></a><span class="bn">    output:</span></span>
<span id="cb17-15"><a href="#cb17-15"></a><span class="bn">    file '*.rds' into A_rds</span></span>
<span id="cb17-16"><a href="#cb17-16"></a>}</span>
<span id="cb17-17"><a href="#cb17-17"></a></span>
<span id="cb17-18"><a href="#cb17-18"></a>process B {</span>
<span id="cb17-19"><a href="#cb17-19"></a><span class="bn">    input:</span></span>
<span id="cb17-20"><a href="#cb17-20"></a><span class="bn">    val include from "B"</span></span>
<span id="cb17-21"><a href="#cb17-21"></a><span class="bn">    file prior from A_B_C_rds</span></span>
<span id="cb17-22"><a href="#cb17-22"></a></span>
<span id="cb17-23"><a href="#cb17-23"></a><span class="bn">    output:</span></span>
<span id="cb17-24"><a href="#cb17-24"></a><span class="bn">    file '*.rds' into B_rds</span></span>
<span id="cb17-25"><a href="#cb17-25"></a>}</span>
<span id="cb17-26"><a href="#cb17-26"></a></span>
<span id="cb17-27"><a href="#cb17-27"></a>process C {</span>
<span id="cb17-28"><a href="#cb17-28"></a><span class="bn">    input:</span></span>
<span id="cb17-29"><a href="#cb17-29"></a><span class="bn">    val include from "C"</span></span>
<span id="cb17-30"><a href="#cb17-30"></a><span class="bn">    file prior from A_B_C_rds</span></span>
<span id="cb17-31"><a href="#cb17-31"></a></span>
<span id="cb17-32"><a href="#cb17-32"></a><span class="bn">    output:</span></span>
<span id="cb17-33"><a href="#cb17-33"></a><span class="bn">    file '*.rds' into C_rds</span></span>
<span id="cb17-34"><a href="#cb17-34"></a>}</span></code></pre></div>
</div>
<div id="workflow-commands" class="section level3">
<h3 class="hasAnchor">
<a href="#workflow-commands" class="anchor"></a>Workflow Commands</h3>
<p><strong>Run Locally</strong></p>
<div class="sourceCode" id="cb18"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb18-1"><a href="#cb18-1"></a><span class="ex">./nextflow</span> workflow.nf -c workflow.config -profile local</span></code></pre></div>
<p><strong>Run on Cloud/Cluster</strong></p>
<div class="sourceCode" id="cb19"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb19-1"><a href="#cb19-1"></a><span class="ex">./nextflow</span> workflow.nf -c workflow.config -profile sge</span></code></pre></div>
<p><strong>Run with Docker Container</strong></p>
<div class="sourceCode" id="cb20"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb20-1"><a href="#cb20-1"></a><span class="ex">./nextflow</span> workflow.nf -c workflow.config -with-docker montilab/shine</span></code></pre></div>
<p><strong>Resume Workflow</strong></p>
<div class="sourceCode" id="cb21"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb21-1"><a href="#cb21-1"></a><span class="ex">./nextflow</span> workflow.nf -resume -c workflow.config</span></code></pre></div>
</div>
<div id="output" class="section level3">
<h3 class="hasAnchor">
<a href="#output" class="anchor"></a>Output</h3>
<p>A successful run should look similar…</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode md"><code class="sourceCode markdown"><span id="cb22-1"><a href="#cb22-1"></a>N E X T F L O W  ~  version 19.10.0</span>
<span id="cb22-2"><a href="#cb22-2"></a>Launching <span class="bn">`workflow.nf`</span> [mad_northcutt] - revision: e7aff2bf48</span>
<span id="cb22-3"><a href="#cb22-3"></a>-</span>
<span id="cb22-4"><a href="#cb22-4"></a>W O R K F L O W ~ Configuration</span>
<span id="cb22-5"><a href="#cb22-5"></a>===============================</span>
<span id="cb22-6"><a href="#cb22-6"></a>data      : /Users/anthonyfederico/Downloads/nextflow/data/data.rds</span>
<span id="cb22-7"><a href="#cb22-7"></a>output    : /Users/anthonyfederico/Downloads/nextflow</span>
<span id="cb22-8"><a href="#cb22-8"></a>-------------------------------</span>
<span id="cb22-9"><a href="#cb22-9"></a></span>
<span id="cb22-10"><a href="#cb22-10"></a>Hierarchy</span>
<span id="cb22-11"><a href="#cb22-11"></a>A_B_C -&gt; A_B</span>
<span id="cb22-12"><a href="#cb22-12"></a>A_B_C -&gt; C</span>
<span id="cb22-13"><a href="#cb22-13"></a>A_B -&gt; A</span>
<span id="cb22-14"><a href="#cb22-14"></a>A_B -&gt; B</span>
<span id="cb22-15"><a href="#cb22-15"></a></span>
<span id="cb22-16"><a href="#cb22-16"></a>-</span>
<span id="cb22-17"><a href="#cb22-17"></a></span>
<span id="cb22-18"><a href="#cb22-18"></a>executor &gt;  local (5)</span>
<span id="cb22-19"><a href="#cb22-19"></a>[4d/715ff1] process &gt; A_B_C [100%] 1 of 1 ✔</span>
<span id="cb22-20"><a href="#cb22-20"></a>[87/c2d03b] process &gt; C     [100%] 1 of 1 ✔</span>
<span id="cb22-21"><a href="#cb22-21"></a>[6b/544fdd] process &gt; A_B   [100%] 1 of 1 ✔</span>
<span id="cb22-22"><a href="#cb22-22"></a>[96/916564] process &gt; A     [100%] 1 of 1 ✔</span>
<span id="cb22-23"><a href="#cb22-23"></a>[43/c599d4] process &gt; B     [100%] 1 of 1 ✔</span>
<span id="cb22-24"><a href="#cb22-24"></a></span>
<span id="cb22-25"><a href="#cb22-25"></a>Completed at: 24-Dec-2019 23:01:05</span>
<span id="cb22-26"><a href="#cb22-26"></a>Duration    : 1m 45s</span>
<span id="cb22-27"><a href="#cb22-27"></a>CPU hours   : 0.1</span>
<span id="cb22-28"><a href="#cb22-28"></a>Succeeded   : 5</span></code></pre></div>
<p>By default, the networks will be saved individually as <code>.rds</code> files within a directory called <em>networks</em>…</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode md"><code class="sourceCode markdown"><span id="cb23-1"><a href="#cb23-1"></a>/nextflow</span>
<span id="cb23-2"><a href="#cb23-2"></a>├── /networks</span>
<span id="cb23-3"><a href="#cb23-3"></a>│   ├── A_B_C.rds</span>
<span id="cb23-4"><a href="#cb23-4"></a>│   ├── A_B.rds</span>
<span id="cb23-5"><a href="#cb23-5"></a>│   ├── A.rds</span>
<span id="cb23-6"><a href="#cb23-6"></a>|   ├── B.rds</span>
<span id="cb23-7"><a href="#cb23-7"></a>|   └── C.rds</span>
<span id="cb23-8"><a href="#cb23-8"></a>|</span>
<span id="cb23-9"><a href="#cb23-9"></a>└── /logs</span></code></pre></div>
<p>Each network is associated with a log file, which records the parameters and progress of the estimation…</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode md"><code class="sourceCode markdown"><span id="cb24-1"><a href="#cb24-1"></a>Parameters</span>
<span id="cb24-2"><a href="#cb24-2"></a>Label: A_B</span>
<span id="cb24-3"><a href="#cb24-3"></a>Data: data.rds</span>
<span id="cb24-4"><a href="#cb24-4"></a>Prior: A_B_C.rds</span>
<span id="cb24-5"><a href="#cb24-5"></a>Condition: subtype</span>
<span id="cb24-6"><a href="#cb24-6"></a>Include: A, B</span>
<span id="cb24-7"><a href="#cb24-7"></a>Iter: 10000</span>
<span id="cb24-8"><a href="#cb24-8"></a>Cores: 3</span>
<span id="cb24-9"><a href="#cb24-9"></a></span>
<span id="cb24-10"><a href="#cb24-10"></a>Data: Features  Samples </span>
<span id="cb24-11"><a href="#cb24-11"></a><span class="bn">      150       20 </span></span>
<span id="cb24-12"><a href="#cb24-12"></a></span>
<span id="cb24-13"><a href="#cb24-13"></a>Samples: A  B </span>
<span id="cb24-14"><a href="#cb24-14"></a><span class="bn">         10 10 </span></span>
<span id="cb24-15"><a href="#cb24-15"></a></span>
<span id="cb24-16"><a href="#cb24-16"></a>Estimate</span>
<span id="cb24-17"><a href="#cb24-17"></a> Iteration  1                 </span>
<span id="cb24-18"><a href="#cb24-18"></a> Iteration  406                 </span>
<span id="cb24-19"><a href="#cb24-19"></a> Iteration  811                 </span>
<span id="cb24-20"><a href="#cb24-20"></a> Iteration  1201                 </span>
<span id="cb24-21"><a href="#cb24-21"></a> Iteration  1606                 </span>
<span id="cb24-22"><a href="#cb24-22"></a> Iteration  2011                 </span>
<span id="cb24-23"><a href="#cb24-23"></a> Iteration  2401                 </span>
<span id="cb24-24"><a href="#cb24-24"></a> Iteration  2806                 </span>
<span id="cb24-25"><a href="#cb24-25"></a> Iteration  3211                 </span>
<span id="cb24-26"><a href="#cb24-26"></a> Iteration  3601                 </span>
<span id="cb24-27"><a href="#cb24-27"></a> Iteration  4006                 </span>
<span id="cb24-28"><a href="#cb24-28"></a> Iteration  4411                 </span>
<span id="cb24-29"><a href="#cb24-29"></a> Iteration  4801                 </span>
<span id="cb24-30"><a href="#cb24-30"></a> Iteration  5206                 </span>
<span id="cb24-31"><a href="#cb24-31"></a> ...</span></code></pre></div>
<p>Networks are saved as <code>bdgraph</code> objects which contain a matrix of posterior edge probabilities as well as the last sampled graph. We can import these networks for analysis directly into <a href="https://github.com/montilab/netviz">Netviz</a>. See the <a href="https://montilab.github.io/shine/articles/docs/netviz.html">next section</a> for more details.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">

        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#requirements-for-nextflow">Requirements for Nextflow</a></li>
      <li><a href="#terminology">Terminology</a></li>
      <li><a href="#example-data">Example Data</a></li>
      <li><a href="#describing-hierarchies">Describing Hierarchies</a></li>
      <li><a href="#filtering-and-constraints">Filtering and Constraints</a></li>
      <li><a href="#generative-workflows">Generative Workflows</a></li>
      </ul>
</div>
      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by <a href="https://github.com/anfederico">Anthony Federico</a>, <a href="https://github.com/tetomonti">Stefano Monti</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
