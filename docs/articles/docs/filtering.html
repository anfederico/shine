<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Filtering Methods • shine</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../../bootstrap-toc.css">
<script src="../../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../../pkgdown.css" rel="stylesheet">
<script src="../../pkgdown.js"></script><meta property="og:title" content="Filtering Methods">
<meta property="og:description" content="shine">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../../index.html">shine</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../../index.html">Home</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Examples
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../../articles/docs/simulations.html">Simulating Graphs</a>
    </li>
    <li>
      <a href="../../articles/docs/filtering.html">Filtering Methods</a>
    </li>
    <li>
      <a href="../../articles/docs/constraints.html">Structure Constraints</a>
    </li>
    <li>
      <a href="../../articles/docs/learning.html">Network Learning</a>
    </li>
  </ul>
</li>
<li>
  <a href="../../reference/index.html">Functionality</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/montilab/shine">
    <span class="fas fa-github"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="filtering_files/accessible-code-block-0.0.1/empty-anchor.js"></script><script src="filtering_files/core-js-2.5.3/shim.min.js"></script><script src="filtering_files/react-17.0.0/react.min.js"></script><script src="filtering_files/react-17.0.0/react-dom.min.js"></script><script src="filtering_files/reactwidget-1.0.0/react-tools.js"></script><script src="filtering_files/htmlwidgets-1.5.3/htmlwidgets.js"></script><script src="filtering_files/reactable-binding-0.2.3/reactable.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Filtering Methods</h1>
            
      
      
      <div class="hidden name"><code>filtering.Rmd</code></div>

    </div>

    
    
<p>There is always a limit to the number of variables that can be used in high-dimensional graphical modeling. This is typically determined by the number of samples available as well as the methodology. In some cases, it may be suitable to build networks on curated genes of interest. In other cases we may need to to filter out genes due some failure to meet a requirement or select genes based on favorable property. We provide some useful functions for variable filtering and selection that consider multiple networks.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">shine</span><span class="op">)</span></code></pre></div>
<p>We use a toy expression set object with three subtypes to illustrate…</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">toy</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">toy</span><span class="op">)</span></code></pre></div>
<pre><code>Features  Samples 
     150       30 </code></pre>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="fu">pData</span><span class="op">(</span><span class="va">toy</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>   subtype
S1       A
S2       A
S3       A
S4       A
S5       A
S6       A</code></pre>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">toy</span><span class="op">$</span><span class="va">subtype</span><span class="op">)</span></code></pre></div>
<pre><code>
 A  B  C 
10 10 10 </code></pre>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">exprs</span><span class="op">(</span><span class="va">toy</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span></code></pre></div>
<pre><code>           S1         S2         S3          S4         S5
G1 -0.2354423 -1.0229070  1.3398810 -0.45969696  2.5326985
G2  0.8372641  0.8283583 -0.6982707  0.21500515 -1.5961633
G3  0.2556321 -0.2623000 -0.6208904 -0.07742454 -0.2845315
G4 -0.3441312  0.5300648 -1.2360177  0.68617017 -1.5084982
G5  1.1543899  0.3910137 -0.4389481 -0.48118378 -1.5107490</code></pre>
<div id="variation-filtering" class="section level1">
<h1 class="hasAnchor">
<a href="#variation-filtering" class="anchor"></a>Variation Filtering</h1>
<p>Graphical modeling considers the co-variance of variables across samples. Therefore, variables must have non-zero variance to be useful. Additionally, when learning multiple networks, the same variable must have non-zero variance within each subtype. Here is a function used to find variables with non-zero variance within every subtype.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">toy</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>[1] "G1" "G2" "G3" "G4" "G5" "G6"</code></pre>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Edit in zero variance in at least one subtype</span>
<span class="fu">exprs</span><span class="op">(</span><span class="va">toy</span><span class="op">)</span><span class="op">[</span><span class="st">"G2"</span>, <span class="va">toy</span><span class="op">$</span><span class="va">subtype</span> <span class="op">==</span> <span class="st">"A"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0</span>

<span class="va">genes.filtered</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/keep.var.html">keep.var</a></span><span class="op">(</span><span class="va">toy</span>, 
                           column<span class="op">=</span><span class="st">"subtype"</span>, 
                           subtypes<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span><span class="op">)</span>, 
                           fn<span class="op">=</span><span class="va">var</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">genes.filtered</span><span class="op">)</span></code></pre></div>
<pre><code>[1] "G1" "G3" "G4" "G5" "G6" "G7"</code></pre>
</div>
<div id="variable-selection" class="section level1">
<h1 class="hasAnchor">
<a href="#variable-selection" class="anchor"></a>Variable Selection</h1>
<p>Even after filtering, there still may be too many variables. One method to reduce the number of variables is to rank them by some favorable property and select the top <em>x</em> amount. When finding structural constraints, we rely on biweight midcorrelation which is more reliable when variables have a high median absolute deviation. Since there are multiple networks, we give each network an opportunity to contribute a high-ranking variable in a turn-based system until the limit has been reached.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">genes.selected</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/rank.var.html">rank.var</a></span><span class="op">(</span><span class="va">toy</span>, 
                           column<span class="op">=</span><span class="st">"subtype"</span>,
                           subtypes<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span><span class="op">)</span>, 
                           limit<span class="op">=</span><span class="fl">30</span>, 
                           genes<span class="op">=</span><span class="va">genes.filtered</span>, 
                           fn<span class="op">=</span><span class="va">mad</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">genes.selected</span><span class="op">)</span></code></pre></div>
<pre><code>[1] "G52"  "G109" "G115" "G10"  "G148" "G117"</code></pre>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">reactable</span><span class="op">(</span><span class="va">rankings</span>,
          compact<span class="op">=</span><span class="cn">TRUE</span>, 
          fullWidth<span class="op">=</span><span class="cn">TRUE</span>,
          defaultPageSize<span class="op">=</span><span class="fl">30</span>,
          striped<span class="op">=</span><span class="cn">TRUE</span>,
          showPageSizeOptions<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<div id="htmlwidget-d65e9536600292a0e8e2" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-d65e9536600292a0e8e2">{"x":{"tag":{"name":"Reactable","attribs":{"data":{".rownames":["G52","G109","G115","G10","G148","G117","G71","G20","G44","G51","G25","G19","G12","G119","G68","G69","G67","G18","G37","G121","G63","G6","G40","G43","G49","G116","G59","G126","G17","G54"],"A":[1,30,3,2,14,28,4,82,6,5,11,53,7,10,66,8,57,20,9,19,65,12,67,33,13,50,27,15,18,32],"B":[1,2,11,6,3,45,15,4,8,7,5,66,31,9,24,82,10,40,52,12,35,20,13,71,22,16,64,19,17,46],"C":[2,17,1,6,93,3,7,15,4,18,8,5,30,39,9,57,14,10,12,76,11,50,23,13,88,73,16,37,40,19]},"columns":[{"accessor":".rownames","name":"","type":"character","sortable":false,"filterable":false},{"accessor":"A","name":"A","type":"numeric"},{"accessor":"B","name":"B","type":"numeric"},{"accessor":"C","name":"C","type":"numeric"}],"defaultPageSize":30,"paginationType":"numbers","showPageInfo":true,"minRows":1,"striped":true,"compact":true,"dataKey":"b794d2db5e5de8df651d07d558acfaa7","key":"b794d2db5e5de8df651d07d558acfaa7"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by <a href="https://github.com/anfederico">Anthony Federico</a>, <a href="https://github.com/tetomonti">Stefano Monti</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
