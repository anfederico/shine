<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Structure Learning Constraints • shine</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../../pkgdown.css" rel="stylesheet">
<script src="../../pkgdown.js"></script><meta property="og:title" content="Structure Learning Constraints">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../../index.html">shine</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../../index.html">Home</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Examples
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../../articles/docs/simulations.html">Simulating Graphs</a>
    </li>
    <li>
      <a href="../../articles/docs/filtering.html">Filtering Methods</a>
    </li>
    <li>
      <a href="../../articles/docs/constraints.html">Structure Learning Constraints</a>
    </li>
    <li>
      <a href="../../articles/docs/hierarchy.html">Hierarchical Networks</a>
    </li>
    <li>
      <a href="../../articles/docs/netviz.html">Network Visualization</a>
    </li>
  </ul>
</li>
<li>
  <a href="../../reference/index.html">Functionality</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/montilab/shine">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Structure Learning Constraints</h1>
            
      
      
      <div class="hidden name"><code>constraints.Rmd</code></div>

    </div>

    
    
<p>To aid in the inference of networks with small sample sizes, we apply biolgically sensible constraints to learning the network structure. To find constraints for the networks, we first establish a network structure in a lower dimensional space (a meta network) using zero-order correlation between genes, which can be computed with few samples.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(shine)</span></code></pre></div>
<div id="step-0---simulated-data" class="section level1">
<h1 class="hasAnchor">
<a href="#step-0---simulated-data" class="anchor"></a>Step 0 - Simulated Data</h1>
<p>As an example, we generate an undirected scale-free network using the Barabási–Albert model with 300 nodes (n) and simulate 100 samples (p) that follow a multivariate normal distribution.</p>
<div id="generate-scale-free-graph" class="section level3">
<h3 class="hasAnchor">
<a href="#generate-scale-free-graph" class="anchor"></a>Generate Scale-Free Graph</h3>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="kw"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="dv">1</span>)</span>
<span id="cb2-2"><a href="#cb2-2"></a>graph &lt;-<span class="st"> </span><span class="kw"><a href="../../reference/sim.graph.html">sim.graph</a></span>(<span class="dv">300</span>)</span>
<span id="cb2-3"><a href="#cb2-3"></a><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(graph, <span class="dt">vertex.color=</span><span class="st">"grey"</span>, <span class="dt">vertex.size=</span><span class="dv">4</span>, <span class="dt">vertex.label=</span><span class="ot">NA</span>)</span></code></pre></div>
<p><img src="constraints_files/figure-html/unnamed-chunk-3-1.png" width="700" style="display: block; margin: auto;"></p>
</div>
<div id="simulate-multivariate-gaussian-data" class="section level3">
<h3 class="hasAnchor">
<a href="#simulate-multivariate-gaussian-data" class="anchor"></a>Simulate Multivariate Gaussian Data</h3>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="kw"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="dv">1</span>)</span>
<span id="cb3-2"><a href="#cb3-2"></a>adj &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span>(igraph<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/igraph/man/as_adjacency_matrix.html">get.adjacency</a></span>(graph))</span>
<span id="cb3-3"><a href="#cb3-3"></a>bdg &lt;-<span class="st"> </span><span class="kw">bdgraph.sim</span>(<span class="dt">n=</span><span class="dv">100</span>, <span class="dt">graph=</span>adj, <span class="dt">type=</span><span class="st">"Gaussian"</span>, <span class="dt">vis=</span>F)</span>
<span id="cb3-4"><a href="#cb3-4"></a>eset &lt;-<span class="st"> </span><span class="kw">ExpressionSet</span>(<span class="kw"><a href="https://rdrr.io/r/base/t.html">t</a></span>(bdg<span class="op">$</span>data))</span></code></pre></div>
</div>
</div>
<div id="step-1---get-modules" class="section level1">
<h1 class="hasAnchor">
<a href="#step-1---get-modules" class="anchor"></a>Step 1 - Get Modules</h1>
<p>We use a specific version of the <a href="https://bmcbioinformatics.biomedcentral.com/articles/10.1186/1471-2105-9-559">Weighted Gene Co-Expression Analysis</a> method to identify gene modules where are clustered by the similarity (measured by biweight midcorrelation) and hierarchically clustered into gene modules of tightly co-expressed genes. Establishing gene modules captures coordinated co-expression of genes in a network that approximately follows a scale free topology, as do most biological networks, however direct gene-gene connections are abstracted away.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a>mods &lt;-<span class="st"> </span><span class="kw"><a href="../../reference/mods.get.html">mods.get</a></span>(eset, <span class="dt">min.size=</span><span class="dv">5</span>, <span class="dt">cores=</span><span class="dv">3</span>, <span class="dt">do.plot=</span><span class="ot">TRUE</span>)</span></code></pre></div>
<p><img src="constraints_files/figure-html/unnamed-chunk-5-1.png" width="700" style="display: block; margin: auto;"><img src="constraints_files/figure-html/unnamed-chunk-5-2.png" width="700" style="display: block; margin: auto;"></p>
</div>
<div id="step-2---build-meta-network" class="section level1">
<h1 class="hasAnchor">
<a href="#step-2---build-meta-network" class="anchor"></a>Step 2 - Build Meta Network</h1>
<p>Using this meta network of co-regulated gene modules, we can represent each module as an eigenvector, which is the first principle component (PC1) of the expression values of genes within a given module, resulting in a module x sample matrix. Within this lower-dimensional representation of the network, we establish conditional independence between modules by measuring the pairwise partial correlation.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a>meta &lt;-<span class="st"> </span><span class="kw"><a href="../../reference/metanet.build.html">metanet.build</a></span>(mods<span class="op">$</span>eigengenes, </span>
<span id="cb5-2"><a href="#cb5-2"></a>                      <span class="dt">cut=</span><span class="fl">0.5</span>, </span>
<span id="cb5-3"><a href="#cb5-3"></a>                      <span class="dt">mpl=</span><span class="ot">TRUE</span>, </span>
<span id="cb5-4"><a href="#cb5-4"></a>                      <span class="dt">iter=</span><span class="dv">20000</span>,</span>
<span id="cb5-5"><a href="#cb5-5"></a>                      <span class="dt">cores=</span><span class="dv">3</span>)</span></code></pre></div>
<p>Here is a visualization of conditional dependence between modules in the meta network…</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a><span class="kw">V</span>(meta<span class="op">$</span>metanet.ig)<span class="op">$</span>color &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/names.html">names</a></span>(<span class="kw">V</span>(meta<span class="op">$</span>metanet.ig))</span>
<span id="cb6-2"><a href="#cb6-2"></a><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(meta<span class="op">$</span>metanet.ig, <span class="dt">vertex.size=</span><span class="dv">10</span>, <span class="dt">edge.width=</span><span class="dv">3</span>, <span class="dt">vertex.label=</span><span class="ot">NA</span>)</span></code></pre></div>
<p><img src="constraints_files/figure-html/unnamed-chunk-7-1.png" width="700" style="display: block; margin: auto;"></p>
<p>Here we relay the modules back on the true graphs structure…</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a><span class="kw">V</span>(graph)<span class="op">$</span>color &lt;-<span class="st"> </span>mods<span class="op">$</span>colors</span>
<span id="cb7-2"><a href="#cb7-2"></a><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(graph, <span class="dt">vertex.size=</span><span class="dv">4</span>, <span class="dt">vertex.label=</span><span class="ot">NA</span>)</span></code></pre></div>
<p><img src="constraints_files/figure-html/unnamed-chunk-8-1.png" width="700" style="display: block; margin: auto;"></p>
</div>
<div id="step-3---knit-blanket" class="section level1">
<h1 class="hasAnchor">
<a href="#step-3---knit-blanket" class="anchor"></a>Step 3 - Knit Blanket</h1>
<p>The Markov blanket for a node in a graphical model contains all the variables that shield the node from the rest of the network. This means that the Markov blanket of a node is the only knowledge needed to predict the behavior of that node and its children. In our case, for each gene, its markov blanket includes genes within its own module, as well as genes in other conditionally dependent modules. These blankets makeup the constraint on the network, which vastly reduces the complexity of the search space.</p>
<p>If the constraints prevent an edge between two genes, there will be a zero-entry in the matrix, otherwise the probability of an edge will be 0.5, assuming no other prior information is being utilized.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a>blanket &lt;-<span class="st"> </span><span class="kw"><a href="../../reference/blanket.new.html">blanket.new</a></span>(mods<span class="op">$</span>genes)</span>
<span id="cb8-2"><a href="#cb8-2"></a>blanket &lt;-<span class="st"> </span><span class="kw"><a href="../../reference/blanket.add.mods.html">blanket.add.mods</a></span>(blanket, mods<span class="op">$</span>mods)</span>
<span id="cb8-3"><a href="#cb8-3"></a>blanket &lt;-<span class="st"> </span><span class="kw"><a href="../../reference/blanket.add.modpairs.html">blanket.add.modpairs</a></span>(blanket, mods<span class="op">$</span>mods, meta<span class="op">$</span>metanet.edges)</span>
<span id="cb8-4"><a href="#cb8-4"></a><span class="kw"><a href="https://rdrr.io/r/base/table.html">table</a></span>(blanket)</span></code></pre></div>
<pre><code>blanket
    0   0.5 
83712  6288 </code></pre>
<p>If a network prior is being used…</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a>blanket &lt;-<span class="st"> </span><span class="kw"><a href="../../reference/blanket.inform.html">blanket.inform</a></span>(blanket, prior)  </span></code></pre></div>
</div>
<div id="step-4---learn-structure" class="section level1">
<h1 class="hasAnchor">
<a href="#step-4---learn-structure" class="anchor"></a>Step 4 - Learn Structure</h1>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a>bdg &lt;-<span class="st"> </span><span class="kw">bdgraph.mpl</span>(<span class="dt">data=</span><span class="kw"><a href="https://rdrr.io/r/base/t.html">t</a></span>(<span class="kw">exprs</span>(eset)), </span>
<span id="cb11-2"><a href="#cb11-2"></a>                   <span class="dt">g.prior=</span>blanket, </span>
<span id="cb11-3"><a href="#cb11-3"></a>                   <span class="dt">method=</span><span class="st">"ggm"</span>, </span>
<span id="cb11-4"><a href="#cb11-4"></a>                   <span class="dt">iter=</span><span class="dv">25000</span>,</span>
<span id="cb11-5"><a href="#cb11-5"></a>                   <span class="dt">cores=</span><span class="dv">3</span>)</span></code></pre></div>
<p>The goal constraint-based structure learning is to reduce the complexity of the search space by instructing the algorithm to only consider graphs with valid edges. By reducing the complexity, we aim to achieve fewer false positives.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a>adj &lt;-<span class="st"> </span>BDgraph<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/BDgraph/man/select.html">select</a></span>(bdg, <span class="dt">cut=</span><span class="fl">0.5</span>)</span>
<span id="cb12-2"><a href="#cb12-2"></a>est &lt;-<span class="st"> </span><span class="kw">graph_from_adjacency_matrix</span>(adj, <span class="dt">mode=</span><span class="st">"undirected"</span>, <span class="dt">diag=</span>F)</span>
<span id="cb12-3"><a href="#cb12-3"></a><span class="kw">V</span>(est)<span class="op">$</span>color &lt;-<span class="st"> </span>mods<span class="op">$</span>colors</span>
<span id="cb12-4"><a href="#cb12-4"></a></span>
<span id="cb12-5"><a href="#cb12-5"></a><span class="kw">E</span>(est)<span class="op">$</span>width &lt;-<span class="st"> </span><span class="dv">1</span></span>
<span id="cb12-6"><a href="#cb12-6"></a><span class="kw">E</span>(est)<span class="op">$</span>color &lt;-<span class="st"> "#030027"</span></span>
<span id="cb12-7"><a href="#cb12-7"></a><span class="kw">E</span>(est)<span class="op">$</span>color[<span class="kw"><a href="../../reference/string.edges.html">string.edges</a></span>(est) <span class="op">%in%</span><span class="st"> </span><span class="kw"><a href="../../reference/string.edges.html">string.edges</a></span>(graph)] &lt;-<span class="st"> "#FFA400"</span></span>
<span id="cb12-8"><a href="#cb12-8"></a><span class="kw">E</span>(est)<span class="op">$</span>width[<span class="kw"><a href="../../reference/string.edges.html">string.edges</a></span>(est) <span class="op">%in%</span><span class="st"> </span><span class="kw"><a href="../../reference/string.edges.html">string.edges</a></span>(graph)] &lt;-<span class="st"> </span><span class="dv">3</span></span>
<span id="cb12-9"><a href="#cb12-9"></a></span>
<span id="cb12-10"><a href="#cb12-10"></a><span class="kw"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>(<span class="dt">mfrow=</span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb12-11"><a href="#cb12-11"></a><span class="kw"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="dv">5</span>)</span>
<span id="cb12-12"><a href="#cb12-12"></a><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(graph, <span class="dt">vertex.size=</span><span class="dv">4</span>, <span class="dt">vertex.label=</span><span class="ot">NA</span>, <span class="dt">label=</span><span class="st">"Truth"</span>)</span>
<span id="cb12-13"><a href="#cb12-13"></a><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(est, <span class="dt">vertex.size=</span><span class="dv">4</span>, <span class="dt">vertex.label=</span><span class="ot">NA</span>, <span class="dt">label=</span><span class="st">"Estimate"</span>)</span></code></pre></div>
<p><img src="constraints_files/figure-html/unnamed-chunk-12-1.png" width="1152" style="display: block; margin: auto;"></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">

        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#step-0---simulated-data">Step 0 - Simulated Data</a></li>
      <li><a href="#step-1---get-modules">Step 1 - Get Modules</a></li>
      <li><a href="#step-2---build-meta-network">Step 2 - Build Meta Network</a></li>
      <li><a href="#step-3---knit-blanket">Step 3 - Knit Blanket</a></li>
      <li><a href="#step-4---learn-structure">Step 4 - Learn Structure</a></li>
      </ul>
</div>
      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by <a href="https://github.com/anfederico">Anthony Federico</a>, <a href="https://github.com/tetomonti">Stefano Monti</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
