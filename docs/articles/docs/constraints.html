<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Structure Learning Constraints • shine</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../../pkgdown.css" rel="stylesheet">
<script src="../../pkgdown.js"></script><meta property="og:title" content="Structure Learning Constraints">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../../index.html">shine</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../../index.html">Home</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Examples
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../../articles/docs/simulations.html">Simulating Graphs</a>
    </li>
    <li>
      <a href="../../articles/docs/filtering.html">Filtering Methods</a>
    </li>
    <li>
      <a href="../../articles/docs/constraints.html">Structure Learning Constraints</a>
    </li>
    <li>
      <a href="../../articles/docs/hierarchy.html">Hierarchical Networks</a>
    </li>
    <li>
      <a href="../../articles/docs/netviz.html">Network Visualization</a>
    </li>
  </ul>
</li>
<li>
  <a href="../../reference/index.html">Functionality</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/montilab/shine">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Structure Learning Constraints</h1>
            
      
      
      <div class="hidden name"><code>constraints.Rmd</code></div>

    </div>

    
    
<p>To aid in the inference of networks with small sample sizes, we apply biolgically sensible constraints to learning the network structure. To find constraints for the networks, we first establish a network structure in a lower dimensional space using zero-order correlation between genes, which can be computed with few samples.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(shine)</span></code></pre></div>
<div id="simulated-data" class="section level1">
<h1 class="hasAnchor">
<a href="#simulated-data" class="anchor"></a>Simulated Data</h1>
<p>As an example, we generate an undirected scale-free network using the Barabási–Albert model with 300 nodes (n) and simulate 100 samples (p) that follow a multivariate normal distribution.</p>
<div id="generate-scale-free-graph" class="section level3">
<h3 class="hasAnchor">
<a href="#generate-scale-free-graph" class="anchor"></a>Generate Scale-Free Graph</h3>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="kw"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="dv">123</span>)</span>
<span id="cb2-2"><a href="#cb2-2"></a>g &lt;-<span class="st"> </span><span class="kw"><a href="../../reference/model.mpa.html">model.mpa</a></span>(<span class="dv">300</span>, <span class="dt">power=</span><span class="fl">1.3</span>)</span>
<span id="cb2-3"><a href="#cb2-3"></a><span class="kw"><a href="../../reference/model.plot.html">model.plot</a></span>(g)</span></code></pre></div>
<p><img src="constraints_files/figure-html/unnamed-chunk-3-1.png" width="700" style="display: block; margin: auto;"></p>
</div>
<div id="simulate-multivariate-gaussian-data" class="section level3">
<h3 class="hasAnchor">
<a href="#simulate-multivariate-gaussian-data" class="anchor"></a>Simulate Multivariate Gaussian Data</h3>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="kw"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="dv">123</span>)</span>
<span id="cb3-2"><a href="#cb3-2"></a>data &lt;-<span class="st"> </span><span class="kw"><a href="../../reference/model.sim.html">model.sim</a></span>(<span class="dt">n=</span><span class="dv">75</span>, g)</span>
<span id="cb3-3"><a href="#cb3-3"></a>bdg &lt;-<span class="st"> </span>data<span class="op">$</span>bdg</span>
<span id="cb3-4"><a href="#cb3-4"></a>eset &lt;-<span class="st"> </span>data<span class="op">$</span>eset</span></code></pre></div>
</div>
</div>
<div id="constraint-methods" class="section level1">
<h1 class="hasAnchor">
<a href="#constraint-methods" class="anchor"></a>Constraint Methods</h1>
<p>We use a specific version of the <a href="https://bmcbioinformatics.biomedcentral.com/articles/10.1186/1471-2105-9-559">Weighted Gene Co-Expression Analysis</a> method to identify gene modules where are clustered by the similarity (measured by biweight midcorrelation) and hierarchically clustered into gene modules of tightly co-expressed genes. Establishing gene modules captures coordinated co-expression of genes in a network that approximately follows a scale free topology, as do most biological networks, however direct gene-gene connections are abstracted away.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a>wgcna &lt;-<span class="st"> </span><span class="kw"><a href="../../reference/mods.detect.html">mods.detect</a></span>(eset, <span class="dt">min.size=</span><span class="dv">5</span>, <span class="dt">cores=</span><span class="dv">3</span>, <span class="dt">do.plot=</span><span class="ot">TRUE</span>)</span></code></pre></div>
<p><img src="constraints_files/figure-html/unnamed-chunk-5-1.png" width="700" style="display: block; margin: auto;"><img src="constraints_files/figure-html/unnamed-chunk-5-2.png" width="700" style="display: block; margin: auto;"></p>
<div id="isolated-modules" class="section level2">
<h2 class="hasAnchor">
<a href="#isolated-modules" class="anchor"></a>Isolated Modules</h2>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a>wgcna<span class="op">$</span>mods<span class="op">$</span>grey &lt;-<span class="st"> </span><span class="ot">NULL</span></span>
<span id="cb5-2"><a href="#cb5-2"></a><span class="kw"><a href="https://rdrr.io/r/utils/str.html">str</a></span>(wgcna<span class="op">$</span>mods)</span></code></pre></div>
<pre><code>List of 19
 $ pink        : chr [1:16] "1" "3" "4" "8" ...
 $ lightcyan   : chr [1:8] "2" "5" "6" "7" ...
 $ tan         : chr [1:11] "11" "98" "161" "229" ...
 $ greenyellow : chr [1:11] "12" "21" "29" "34" ...
 $ lightgreen  : chr [1:7] "13" "24" "30" "33" ...
 $ green       : chr [1:20] "15" "17" "18" "67" ...
 $ yellow      : chr [1:21] "16" "36" "45" "57" ...
 $ midnightblue: chr [1:8] "19" "23" "27" "35" ...
 $ cyan        : chr [1:8] "25" "26" "204" "205" ...
 $ magenta     : chr [1:14] "28" "107" "128" "144" ...
 $ turquoise   : chr [1:36] "31" "40" "44" "63" ...
 $ salmon      : chr [1:10] "39" "99" "100" "108" ...
 $ blue        : chr [1:31] "42" "54" "70" "78" ...
 $ black       : chr [1:16] "49" "62" "69" "76" ...
 $ brown       : chr [1:27] "50" "51" "52" "55" ...
 $ purple      : chr [1:12] "79" "154" "201" "215" ...
 $ grey60      : chr [1:7] "85" "153" "158" "160" ...
 $ red         : chr [1:16] "88" "105" "118" "120" ...
 $ lightyellow : chr [1:5] "124" "256" "277" "280" ...</code></pre>
<p>The Markov blanket for a node in a graphical model contains all the variables that shield the node from the rest of the network. This means that the Markov blanket of a node is the only knowledge needed to predict the behavior of that node and its children.</p>
<p>In our case, for each gene, its markov blanket includes genes within its own module. These blankets makeup the constraint on the network, which vastly reduces the complexity of the search space. If the constraints prevent an edge between two genes, there will be a zero-entry in the matrix, otherwise the probability of an edge will be 0.5, assuming no other prior information is being incorporated.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a>blanket &lt;-<span class="st"> </span><span class="kw"><a href="../../reference/blanket.new.html">blanket.new</a></span>(wgcna<span class="op">$</span>genes)</span>
<span id="cb7-2"><a href="#cb7-2"></a>blanket &lt;-<span class="st"> </span><span class="kw"><a href="../../reference/blanket.lift.html">blanket.lift</a></span>(blanket, wgcna<span class="op">$</span>mods)</span></code></pre></div>
<p>Here we relay the modules back on the true graphs structure…</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a><span class="kw">V</span>(g)<span class="op">$</span>color &lt;-<span class="st"> </span>wgcna<span class="op">$</span>colors</span>
<span id="cb8-2"><a href="#cb8-2"></a><span class="kw"><a href="../../reference/model.plot.html">model.plot</a></span>(g, <span class="dt">colors=</span><span class="ot">TRUE</span>)</span></code></pre></div>
<p><img src="constraints_files/figure-html/unnamed-chunk-8-1.png" width="700" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a><span class="kw"><a href="../../reference/blanket.cred.html">blanket.cred</a></span>(blanket)</span></code></pre></div>
<pre><code>[1] 16.22871</code></pre>
</div>
<div id="fuzzy-modules" class="section level2">
<h2 class="hasAnchor">
<a href="#fuzzy-modules" class="anchor"></a>Fuzzy Modules</h2>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a><span class="kw"><a href="../../reference/mods.plot.html">mods.plot</a></span>(wgcna<span class="op">$</span>dat, wgcna<span class="op">$</span>mods, wgcna<span class="op">$</span>colors, <span class="dt">size=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="constraints_files/figure-html/unnamed-chunk-10-1.png" width="1152" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a><span class="kw"><a href="../../reference/mod.plot.html">mod.plot</a></span>(wgcna<span class="op">$</span>dat, wgcna<span class="op">$</span>mods, <span class="dt">mod=</span><span class="st">"green"</span>, wgcna<span class="op">$</span>colors, <span class="dt">size=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="constraints_files/figure-html/unnamed-chunk-11-1.png" width="700" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a><span class="kw"><a href="../../reference/fuzzy.plot.html">fuzzy.plot</a></span>(wgcna<span class="op">$</span>dat, wgcna<span class="op">$</span>mods, <span class="dt">mod=</span><span class="st">"green"</span>, <span class="dt">size=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="constraints_files/figure-html/unnamed-chunk-12-1.png" width="700" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a>fuzzy &lt;-<span class="st"> </span><span class="kw"><a href="../../reference/fuzzy.mods.html">fuzzy.mods</a></span>(wgcna<span class="op">$</span>dat, wgcna<span class="op">$</span>mods)</span>
<span id="cb14-2"><a href="#cb14-2"></a></span>
<span id="cb14-3"><a href="#cb14-3"></a>blanket &lt;-<span class="st"> </span><span class="kw"><a href="../../reference/blanket.new.html">blanket.new</a></span>(wgcna<span class="op">$</span>genes)</span>
<span id="cb14-4"><a href="#cb14-4"></a>blanket &lt;-<span class="st"> </span><span class="kw"><a href="../../reference/blanket.lift.html">blanket.lift</a></span>(blanket, fuzzy)</span>
<span id="cb14-5"><a href="#cb14-5"></a><span class="kw"><a href="../../reference/blanket.cred.html">blanket.cred</a></span>(blanket)</span></code></pre></div>
<pre><code>[1] 6.375222</code></pre>
</div>
<div id="metanet" class="section level2">
<h2 class="hasAnchor">
<a href="#metanet" class="anchor"></a>Metanet</h2>
<p>Using a meta network of co-regulated gene modules, we can represent each module as an eigenvector, which is the first principle component (PC1) of the expression values of genes within a given module, resulting in a module x sample matrix. Within this lower-dimensional representation of the network, we establish conditional independence between modules by measuring the pairwise partial correlation.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a>wgcna<span class="op">$</span>mods<span class="op">$</span>grey &lt;-<span class="st"> </span><span class="ot">NULL</span>    </span>
<span id="cb16-2"><a href="#cb16-2"></a>wgcna<span class="op">$</span>eigengenes<span class="op">$</span>grey &lt;-<span class="st"> </span><span class="ot">NULL</span></span>
<span id="cb16-3"><a href="#cb16-3"></a>  </span>
<span id="cb16-4"><a href="#cb16-4"></a><span class="co"># Estimate meta network</span></span>
<span id="cb16-5"><a href="#cb16-5"></a>metanet &lt;-<span class="st"> </span><span class="kw"><a href="../../reference/bdg.metanet.html">bdg.metanet</a></span>(wgcna<span class="op">$</span>eigengenes, <span class="dt">mpl=</span><span class="ot">TRUE</span>, <span class="dt">iter=</span><span class="dv">25000</span>, <span class="dt">print=</span><span class="dv">5000</span>, <span class="dt">cores=</span><span class="dv">3</span>)</span></code></pre></div>
<pre><code>25000 iteration is started.                     
 Iteration  5000                 
 Iteration  10000                 
 Iteration  15000                 
 Iteration  20000                 
 Iteration  25000                 </code></pre>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a><span class="kw">V</span>(metanet<span class="op">$</span>ig)<span class="op">$</span>color &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/names.html">names</a></span>(<span class="kw">V</span>(metanet<span class="op">$</span>ig))</span>
<span id="cb18-2"><a href="#cb18-2"></a><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(metanet<span class="op">$</span>ig, <span class="dt">vertex.size=</span><span class="dv">10</span>, <span class="dt">edge.width=</span><span class="dv">3</span>, <span class="dt">vertex.label=</span><span class="ot">NA</span>)</span></code></pre></div>
<p><img src="constraints_files/figure-html/unnamed-chunk-15-1.png" width="700" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a>blanket &lt;-<span class="st"> </span><span class="kw"><a href="../../reference/blanket.new.html">blanket.new</a></span>(wgcna<span class="op">$</span>genes)</span>
<span id="cb19-2"><a href="#cb19-2"></a>blanket &lt;-<span class="st"> </span><span class="kw"><a href="../../reference/blanket.lift.html">blanket.lift</a></span>(blanket, wgcna<span class="op">$</span>mods, metanet<span class="op">$</span>edges)</span>
<span id="cb19-3"><a href="#cb19-3"></a><span class="kw"><a href="../../reference/blanket.cred.html">blanket.cred</a></span>(blanket)</span></code></pre></div>
<pre><code>[1] 9.096304</code></pre>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">

        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#simulated-data">Simulated Data</a></li>
      <li>
<a href="#constraint-methods">Constraint Methods</a><ul class="nav nav-pills nav-stacked">
<li><a href="#isolated-modules">Isolated Modules</a></li>
      <li><a href="#fuzzy-modules">Fuzzy Modules</a></li>
      <li><a href="#metanet">Metanet</a></li>
      </ul>
</li>
      </ul>
</div>
      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by <a href="https://github.com/anfederico">Anthony Federico</a>, <a href="https://github.com/tetomonti">Stefano Monti</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
